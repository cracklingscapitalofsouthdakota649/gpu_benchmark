[pytest]
# -------------------------------------------------------------------
# Pytest Configuration for GPU/CPU Benchmark & Allure Reporting (Linux CI)
# -------------------------------------------------------------------
pythonpath = .
minversion = 8.0
timeout_method = thread
timeout_func_only = true

testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

markers =
    gpu: GPU-related tests (generic CUDA/ROCm/Intel)
    cpu: CPU-bound tests
    nvidia: NVIDIA-specific tests
    amd: AMD-specific tests
    intel: Intel-specific tests
    benchmark: Performance benchmarking
    stress: Heavy-load or endurance tests
    preprocess: Data preprocessing
    accelerator: GPU accelerator tasks
    io_accelerator: I/O accelerator performance tests
    network_io_accelerator: Network I/O accelerator performance tests

addopts =
    --tb=short
    --alluredir=allure-results
    --benchmark-json=allure-results/benchmark.json
    --benchmark-save=latest
    --benchmark-autosave
    --benchmark-min-rounds=5
    --disable-warnings
    -v
    -ra -q
    --maxfail=3
    --durations=10

filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning
    ignore::RuntimeWarning
    ignore::FutureWarning

env =
    PYTHONUNBUFFERED=1
    PYTEST_DISABLE_PLUGIN_AUTOLOAD=1
    MPLCONFIGDIR=/tmp/matplotlib-cache
    NUMEXPR_MAX_THREADS=8
    OMP_NUM_THREADS=8
    CUDA_VISIBLE_DEVICES=0

faulthandler_timeout = 60
asyncio_mode = auto
norecursedirs = .* build dist venv .venv .cache
